[
    {
      "id": 1,
      "question": "List all sector names and their IDs",
      "ground_truth_sql": "SELECT sector_id, sector_name FROM sectors ORDER BY sector_id",
      "difficulty": "simple",
      "category": "select_all"
    },
    {
      "id": 2,
      "question": "Find all countries with 'United' in their name",
      "ground_truth_sql": "SELECT country_name FROM countries WHERE country_name LIKE '%United%'",
      "difficulty": "simple",
      "category": "pattern_match"
    },
    {
      "id": 3,
      "question": "How many GFS indicators are there?",
      "ground_truth_sql": "SELECT COUNT(*) AS gfs_indicator_count FROM indicators WHERE source = 'GFS'",
      "difficulty": "simple",
      "category": "count_filtered"
    },
    {
      "id": 4,
      "question": "List all GFS indicator names that contain 'Revenue'",
      "ground_truth_sql": "SELECT DISTINCT indicator_name FROM indicators WHERE source = 'GFS' AND indicator_name LIKE '%Revenue%'",
      "difficulty": "simple",
      "category": "pattern_match"
    },
    {
      "id": 5,
      "question": "List countries whose names start with 'A'",
      "ground_truth_sql": "SELECT country_name FROM countries WHERE country_name LIKE 'A%' ORDER BY country_name",
      "difficulty": "simple",
      "category": "pattern_match"
    },
    {
      "id": 6,
      "question": "How many GEM observations are in the database?",
      "ground_truth_sql": "SELECT COUNT(*) AS observation_count FROM gem_observations",
      "difficulty": "simple",
      "category": "count"
    },
    {
      "id": 7,
      "question": "How many GFS observations are in the database?",
      "ground_truth_sql": "SELECT COUNT(*) AS observation_count FROM gfs_observations",
      "difficulty": "simple",
      "category": "count"
    },
    {
      "id": 8,
      "question": "List all distinct GEM indicator names",
      "ground_truth_sql": "SELECT DISTINCT indicator_name FROM indicators WHERE source = 'GEM' ORDER BY indicator_name",
      "difficulty": "simple",
      "category": "distinct_filtered"
    },
    {
      "id": 9,
      "question": "How many GEM indicators are there?",
      "ground_truth_sql": "SELECT COUNT(*) AS gem_indicator_count FROM indicators WHERE source = 'GEM'",
      "difficulty": "simple",
      "category": "count_filtered"
    },
    {
      "id": 10,
      "question": "What is the earliest year in the GFS observations?",
      "ground_truth_sql": "SELECT MIN(year) AS earliest_year FROM gfs_observations",
      "difficulty": "simple",
      "category": "min"
    },
    {
      "id": 11,
      "question": "How many different indicators are there in total?",
      "ground_truth_sql": "SELECT COUNT(*) AS indicator_count FROM indicators",
      "difficulty": "simple",
      "category": "count"
    },
    {
      "id": 12,
      "question": "How many distinct countries have GEM data?",
      "ground_truth_sql": "SELECT COUNT(DISTINCT country_id) AS country_count FROM gem_observations",
      "difficulty": "simple",
      "category": "count_distinct"
    },
    {
      "id": 13,
      "question": "Find the minimum value in GEM observations (excluding nulls)",
      "ground_truth_sql": "SELECT MIN(value) AS min_value FROM gem_observations WHERE value IS NOT NULL",
      "difficulty": "simple",
      "category": "min"
    },
    {
      "id": 14,
      "question": "How many observations have 'Percent of GDP' as the transformation?",
      "ground_truth_sql": "SELECT COUNT(*) AS count FROM gfs_observations WHERE transformation = 'Percent of GDP'",
      "difficulty": "simple",
      "category": "count_filtered"
    },
    {
      "id": 15,
      "question": "What is the latest year in the GEM observations?",
      "ground_truth_sql": "SELECT MAX(year) AS latest_year FROM gem_observations",
      "difficulty": "simple",
      "category": "max"
    },
    {
      "id": 16,
      "question": "List all GFS indicator names that contain 'Expense'",
      "ground_truth_sql": "SELECT DISTINCT indicator_name FROM indicators WHERE source = 'GFS' AND indicator_name LIKE '%Expense%'",
      "difficulty": "simple",
      "category": "pattern_match"
    },
    {
      "id": 17,
      "question": "How many countries are in the database?",
      "ground_truth_sql": "SELECT COUNT(*) AS country_count FROM countries",
      "difficulty": "simple",
      "category": "count"
    },
    {
      "id": 18,
      "question": "Find the country ID for Brazil",
      "ground_truth_sql": "SELECT country_id, country_name FROM countries WHERE country_name = 'Brazil'",
      "difficulty": "simple",
      "category": "lookup"
    },
    {
      "id": 19,
      "question": "How many GEM observations are from the year 2020?",
      "ground_truth_sql": "SELECT COUNT(*) AS obs_count FROM gem_observations WHERE year = 2020",
      "difficulty": "simple",
      "category": "count_filtered"
    },
    {
      "id": 20,
      "question": "List all available sectors in the GFS data",
      "ground_truth_sql": "SELECT sector_name FROM sectors ORDER BY sector_name",
      "difficulty": "simple",
      "category": "select_all"
    },
    {
      "id": 21,
      "question": "How many GFS observations are from the year 2020?",
      "ground_truth_sql": "SELECT COUNT(*) AS obs_count FROM gfs_observations WHERE year = 2020",
      "difficulty": "simple",
      "category": "count_filtered"
    },
    {
      "id": 22,
      "question": "List countries with GFS data available for 2023",
      "ground_truth_sql": "SELECT DISTINCT c.country_name\nFROM gfs_observations g\nJOIN countries c ON g.country_id = c.country_id\nWHERE g.year = 2023\nORDER BY c.country_name",
      "difficulty": "medium",
      "category": "join_filter"
    },
    {
      "id": 23,
      "question": "List all years where France has general government GFS data",
      "ground_truth_sql": "SELECT DISTINCT g.year\nFROM gfs_observations g\nJOIN countries c ON g.country_id = c.country_id\nJOIN sectors s ON g.sector_id = s.sector_id\nWHERE c.country_name = 'France'\nAND s.sector_name = 'General government'\nORDER BY g.year",
      "difficulty": "medium",
      "category": "join_filter"
    },
    {
      "id": 24,
      "question": "Show total government expenditure (percent of GDP) for Brazil from 2015 to 2022",
      "ground_truth_sql": "SELECT g.year, g.value AS expenditure_pct_gdp\nFROM gfs_observations g\nJOIN countries c ON g.country_id = c.country_id\nJOIN sectors s ON g.sector_id = s.sector_id\nJOIN indicators i ON g.indicator_id = i.indicator_id\nWHERE c.country_name = 'Brazil'\nAND s.sector_name = 'General government'\nAND i.indicator_name = 'Expenditure, Transactions (cash basis of recording), Cash basis'\nAND g.transformation = 'Percent of GDP'\nAND g.year BETWEEN 2015 AND 2022\nORDER BY g.year",
      "difficulty": "medium",
      "category": "join_filter"
    },
    {
      "id": 25,
      "question": "What is the average revenue (percent of GDP) for general government in 2020 across all countries?",
      "ground_truth_sql": "SELECT AVG(g.value) AS avg_revenue_pct_gdp\nFROM gfs_observations g\nJOIN sectors s ON g.sector_id = s.sector_id\nJOIN indicators i ON g.indicator_id = i.indicator_id\nWHERE s.sector_name = 'General government'\nAND i.indicator_name = 'Revenue, Transactions (cash basis of recording), Cash basis'\nAND g.transformation = 'Percent of GDP'\nAND g.year = 2020",
      "difficulty": "medium",
      "category": "join_aggregation"
    },
    {
      "id": 26,
      "question": "What is the total count of observations per GEM indicator?",
      "ground_truth_sql": "SELECT i.indicator_name, i.unit, COUNT(*) AS obs_count\nFROM gem_observations g\nJOIN indicators i ON g.indicator_id = i.indicator_id\nGROUP BY i.indicator_name, i.unit\nORDER BY obs_count DESC",
      "difficulty": "medium",
      "category": "join_aggregation"
    },
    {
      "id": 27,
      "question": "Count GFS observations by scale type",
      "ground_truth_sql": "SELECT scale, COUNT(*) AS obs_count\nFROM gfs_observations\nGROUP BY scale\nORDER BY obs_count DESC",
      "difficulty": "medium",
      "category": "aggregation"
    },
    {
      "id": 28,
      "question": "Count how many countries have GEM unemployment data for each year",
      "ground_truth_sql": "SELECT g.year, COUNT(DISTINCT g.country_id) AS country_count\nFROM gem_observations g\nJOIN indicators i ON g.indicator_id = i.indicator_id\nWHERE i.indicator_name = 'Unemployment Rate'\nGROUP BY g.year\nORDER BY g.year",
      "difficulty": "medium",
      "category": "join_aggregation"
    },
    {
      "id": 29,
      "question": "Count the number of countries with GEM data for each year",
      "ground_truth_sql": "SELECT year, COUNT(DISTINCT country_id) AS country_count\nFROM gem_observations\nGROUP BY year\nORDER BY year",
      "difficulty": "medium",
      "category": "aggregation"
    },
    {
      "id": 30,
      "question": "List the 10 countries with the highest GDP (constant 2010 US$) in 2019",
      "ground_truth_sql": "SELECT c.country_name, g.value AS gdp_millions\nFROM gem_observations g\nJOIN countries c ON g.country_id = c.country_id\nJOIN indicators i ON g.indicator_id = i.indicator_id\nWHERE i.indicator_name = 'GDP at market prices'\nAND i.unit = 'constant 2010 US$, millions'\nAND g.year = 2019\nORDER BY g.value DESC\nLIMIT 10",
      "difficulty": "medium",
      "category": "join_filter_limit"
    },
    {
      "id": 31,
      "question": "What is the average value by sector for GFS observations in 2020?",
      "ground_truth_sql": "SELECT s.sector_name, AVG(g.value) AS avg_value\nFROM gfs_observations g\nJOIN sectors s ON g.sector_id = s.sector_id\nWHERE g.year = 2020\nGROUP BY s.sector_name\nORDER BY avg_value DESC",
      "difficulty": "medium",
      "category": "join_aggregation"
    },
    {
      "id": 32,
      "question": "Count the number of GFS observations per year for the United States",
      "ground_truth_sql": "SELECT g.year, COUNT(*) AS obs_count\nFROM gfs_observations g\nJOIN countries c ON g.country_id = c.country_id\nWHERE c.country_name = 'United States'\nGROUP BY g.year\nORDER BY g.year",
      "difficulty": "medium",
      "category": "join_aggregation"
    },
    {
      "id": 33,
      "question": "Show terms of trade for Australia from 2010 to 2023",
      "ground_truth_sql": "SELECT g.year, g.value AS terms_of_trade\nFROM gem_observations g\nJOIN countries c ON g.country_id = c.country_id\nJOIN indicators i ON g.indicator_id = i.indicator_id\nWHERE c.country_name = 'Australia'\nAND i.indicator_name = 'Terms of Trade'\nAND g.year BETWEEN 2010 AND 2023\nORDER BY g.year",
      "difficulty": "medium",
      "category": "join_filter"
    },
    {
      "id": 34,
      "question": "Show the exchange rate for Mexico from 2015 to 2023",
      "ground_truth_sql": "SELECT g.year, g.value AS exchange_rate\nFROM gem_observations g\nJOIN countries c ON g.country_id = c.country_id\nJOIN indicators i ON g.indicator_id = i.indicator_id\nWHERE c.country_name = 'Mexico'\nAND i.indicator_name = 'Exchange rate'\nAND g.year BETWEEN 2015 AND 2023\nORDER BY g.year",
      "difficulty": "medium",
      "category": "join_filter"
    },
    {
      "id": 35,
      "question": "List countries and the number of GFS observations for each",
      "ground_truth_sql": "SELECT c.country_name, COUNT(*) AS obs_count\nFROM gfs_observations g\nJOIN countries c ON g.country_id = c.country_id\nGROUP BY c.country_name\nORDER BY obs_count DESC",
      "difficulty": "medium",
      "category": "join_aggregation"
    },
    {
      "id": 36,
      "question": "What is the maximum unemployment rate recorded in GEM data and which country-year?",
      "ground_truth_sql": "SELECT c.country_name, g.year, g.value AS unemployment_rate\nFROM gem_observations g\nJOIN countries c ON g.country_id = c.country_id\nJOIN indicators i ON g.indicator_id = i.indicator_id\nWHERE i.indicator_name = 'Unemployment Rate'\nORDER BY g.value DESC\nLIMIT 1",
      "difficulty": "medium",
      "category": "join_filter_limit"
    },
    {
      "id": 37,
      "question": "Show GDP at market prices for the United States for all available years",
      "ground_truth_sql": "SELECT g.year, g.value AS gdp_millions\nFROM gem_observations g\nJOIN countries c ON g.country_id = c.country_id\nJOIN indicators i ON g.indicator_id = i.indicator_id\nWHERE c.country_name = 'United States'\nAND i.indicator_name = 'GDP at market prices'\nAND i.unit = 'constant 2010 US$, millions'\nORDER BY g.year",
      "difficulty": "medium",
      "category": "join_filter"
    },
    {
      "id": 38,
      "question": "Find country-years with high unemployment rate (>10%) from GEM data between 2010 and 2020",
      "ground_truth_sql": "SELECT\n    c.country_name,\n    g.year,\n    g.value AS unemployment_rate\nFROM gem_observations g\nJOIN countries c ON g.country_id = c.country_id\nJOIN indicators i ON g.indicator_id = i.indicator_id\nWHERE i.indicator_name = 'Unemployment Rate'\n    AND g.year BETWEEN 2010 AND 2020\n    AND g.value > 10\nORDER BY g.value DESC",
      "difficulty": "medium",
      "category": "filtering"
    },
    {
      "id": 39,
      "question": "Show government social benefits (percent of GDP) for Germany from 2000 to 2020",
      "ground_truth_sql": "SELECT g.year, g.value AS social_benefits_pct_gdp\nFROM gfs_observations g\nJOIN countries c ON g.country_id = c.country_id\nJOIN sectors s ON g.sector_id = s.sector_id\nJOIN indicators i ON g.indicator_id = i.indicator_id\nWHERE c.country_name = 'Germany'\nAND s.sector_name = 'General government'\nAND i.indicator_name = 'Social benefits, Transactions (cash basis of recording), Cash basis'\nAND g.transformation = 'Percent of GDP'\nAND g.year BETWEEN 2000 AND 2020\nORDER BY g.year",
      "difficulty": "medium",
      "category": "join_filter"
    },
    {
      "id": 40,
      "question": "Show imports merchandise for India from 2010 to 2020",
      "ground_truth_sql": "SELECT g.year, g.value AS imports\nFROM gem_observations g\nJOIN countries c ON g.country_id = c.country_id\nJOIN indicators i ON g.indicator_id = i.indicator_id\nWHERE c.country_name = 'India'\nAND i.indicator_name = 'Imports Merchandise'\nAND g.year BETWEEN 2010 AND 2020\nORDER BY g.year",
      "difficulty": "medium",
      "category": "join_filter"
    },
    {
      "id": 41,
      "question": "List all countries with tax revenue data for 2020",
      "ground_truth_sql": "SELECT DISTINCT c.country_name\nFROM gfs_observations g\nJOIN countries c ON g.country_id = c.country_id\nJOIN indicators i ON g.indicator_id = i.indicator_id\nWHERE i.indicator_name = 'Taxes, Transactions (cash basis of recording), Cash basis'\nAND g.year = 2020\nORDER BY c.country_name",
      "difficulty": "medium",
      "category": "join_filter"
    },
    {
      "id": 42,
      "question": "List the top 5 countries by number of GEM observations",
      "ground_truth_sql": "SELECT c.country_name, COUNT(*) AS obs_count\nFROM gem_observations g\nJOIN countries c ON g.country_id = c.country_id\nGROUP BY c.country_name\nORDER BY obs_count DESC\nLIMIT 5",
      "difficulty": "medium",
      "category": "join_aggregation_limit"
    },
    {
      "id": 43,
      "question": "Show the CPI Price (% y-o-y) for Japan from 2015 to 2023",
      "ground_truth_sql": "SELECT g.year, g.value AS cpi_yoy\nFROM gem_observations g\nJOIN countries c ON g.country_id = c.country_id\nJOIN indicators i ON g.indicator_id = i.indicator_id\nWHERE c.country_name = 'Japan'\nAND i.indicator_name = 'CPI Price'\nAND i.unit = '% y-o-y, nominal'\nAND g.year BETWEEN 2015 AND 2023\nORDER BY g.year",
      "difficulty": "medium",
      "category": "join_filter"
    },
    {
      "id": 44,
      "question": "What is the average expenditure (percent of GDP) for general government across all countries in 2019?",
      "ground_truth_sql": "SELECT AVG(g.value) AS avg_expenditure_pct_gdp\nFROM gfs_observations g\nJOIN sectors s ON g.sector_id = s.sector_id\nJOIN indicators i ON g.indicator_id = i.indicator_id\nWHERE s.sector_name = 'General government'\nAND i.indicator_name = 'Expenditure, Transactions (cash basis of recording), Cash basis'\nAND g.transformation = 'Percent of GDP'\nAND g.year = 2019",
      "difficulty": "medium",
      "category": "join_aggregation"
    },
    {
      "id": 45,
      "question": "Show the stock market index for the United Kingdom from 2015 to 2023",
      "ground_truth_sql": "SELECT g.year, g.value AS stock_market\nFROM gem_observations g\nJOIN countries c ON g.country_id = c.country_id\nJOIN indicators i ON g.indicator_id = i.indicator_id\nWHERE c.country_name = 'United Kingdom'\nAND i.indicator_name = 'Stock Markets'\nAND g.year BETWEEN 2015 AND 2023\nORDER BY g.year",
      "difficulty": "medium",
      "category": "join_filter"
    },
    {
      "id": 46,
      "question": "Show exports merchandise (current US$ millions) for Brazil from 2010 to 2020",
      "ground_truth_sql": "SELECT g.year, g.value AS exports_millions\nFROM gem_observations g\nJOIN countries c ON g.country_id = c.country_id\nJOIN indicators i ON g.indicator_id = i.indicator_id\nWHERE c.country_name = 'Brazil'\nAND i.indicator_name = 'Exports Merchandise'\nAND i.unit LIKE '%current US$%'\nAND g.year BETWEEN 2010 AND 2020\nORDER BY g.year",
      "difficulty": "medium",
      "category": "join_filter"
    },
    {
      "id": 47,
      "question": "List all countries that have data for both GFS and GEM",
      "ground_truth_sql": "SELECT DISTINCT c.country_name\nFROM countries c\nWHERE c.country_id IN (SELECT DISTINCT country_id FROM gfs_observations)\nAND c.country_id IN (SELECT DISTINCT country_id FROM gem_observations)\nORDER BY c.country_name",
      "difficulty": "medium",
      "category": "subquery"
    },
    {
      "id": 48,
      "question": "Show the unemployment rate for Germany for all available years",
      "ground_truth_sql": "SELECT g.year, g.value AS unemployment_rate\nFROM gem_observations g\nJOIN countries c ON g.country_id = c.country_id\nJOIN indicators i ON g.indicator_id = i.indicator_id\nWHERE c.country_name = 'Germany'\nAND i.indicator_name = 'Unemployment Rate'\nORDER BY g.year",
      "difficulty": "medium",
      "category": "join_filter"
    },
    {
      "id": 49,
      "question": "Using GEM CPI data, find countries where inflation (CPI % year-over-year) exceeded 10% in any year between 2015 and 2023",
      "ground_truth_sql": "SELECT DISTINCT\n    c.country_name,\n    g.year,\n    g.value AS cpi_yoy_pct\nFROM gem_observations g\nJOIN countries c ON g.country_id = c.country_id\nJOIN indicators i ON g.indicator_id = i.indicator_id\nWHERE i.indicator_name = 'CPI Price'\n    AND i.unit = '% y-o-y, nominal'\n    AND g.year BETWEEN 2015 AND 2023\n    AND g.value > 10\nORDER BY g.value DESC",
      "difficulty": "medium",
      "category": "filtering"
    },
    {
      "id": 50,
      "question": "Count GFS observations per country per year (limited to 2020)",
      "ground_truth_sql": "SELECT c.country_name, g.year, COUNT(*) AS obs_count\nFROM gfs_observations g\nJOIN countries c ON g.country_id = c.country_id\nWHERE g.year = 2020\nGROUP BY c.country_name, g.year\nORDER BY obs_count DESC\nLIMIT 20",
      "difficulty": "medium",
      "category": "join_aggregation"
    },
    {
      "id": 51,
      "question": "Count the number of countries with GFS data for each year",
      "ground_truth_sql": "SELECT year, COUNT(DISTINCT country_id) AS country_count\nFROM gfs_observations\nGROUP BY year\nORDER BY year",
      "difficulty": "medium",
      "category": "aggregation"
    },
    {
      "id": 52,
      "question": "Count GFS observations by transformation type",
      "ground_truth_sql": "SELECT transformation, COUNT(*) AS obs_count\nFROM gfs_observations\nGROUP BY transformation\nORDER BY obs_count DESC",
      "difficulty": "medium",
      "category": "aggregation"
    },
    {
      "id": 53,
      "question": "Calculate average GDP at market prices (constant 2010 US$) by country for 2015-2020, and rank the top 10 countries",
      "ground_truth_sql": "SELECT\n    c.country_name,\n    AVG(g.value) AS avg_gdp_millions,\n    COUNT(*) AS years_of_data\nFROM gem_observations g\nJOIN countries c ON g.country_id = c.country_id\nJOIN indicators i ON g.indicator_id = i.indicator_id\nWHERE i.indicator_name = 'GDP at market prices'\n    AND i.unit = 'constant 2010 US$, millions'\n    AND g.year BETWEEN 2015 AND 2020\nGROUP BY c.country_name\nORDER BY avg_gdp_millions DESC\nLIMIT 10",
      "difficulty": "medium",
      "category": "aggregation_ranking"
    },
    {
      "id": 54,
      "question": "Show government revenue (percent of GDP) for Australia from 2010 to 2020",
      "ground_truth_sql": "SELECT g.year, g.value AS revenue_pct_gdp\nFROM gfs_observations g\nJOIN countries c ON g.country_id = c.country_id\nJOIN sectors s ON g.sector_id = s.sector_id\nJOIN indicators i ON g.indicator_id = i.indicator_id\nWHERE c.country_name = 'Australia'\nAND s.sector_name = 'General government'\nAND i.indicator_name = 'Revenue, Transactions (cash basis of recording), Cash basis'\nAND g.transformation = 'Percent of GDP'\nAND g.year BETWEEN 2010 AND 2020\nORDER BY g.year",
      "difficulty": "medium",
      "category": "join_filter"
    },
    {
      "id": 55,
      "question": "What is the sum of all GFS observation values for the year 2020?",
      "ground_truth_sql": "SELECT SUM(value) AS total_value\nFROM gfs_observations\nWHERE year = 2020",
      "difficulty": "medium",
      "category": "aggregation"
    },
    {
      "id": 56,
      "question": "Show the total reserves for China from 2010 to 2020",
      "ground_truth_sql": "SELECT g.year, g.value AS total_reserves\nFROM gem_observations g\nJOIN countries c ON g.country_id = c.country_id\nJOIN indicators i ON g.indicator_id = i.indicator_id\nWHERE c.country_name = 'China'\nAND i.indicator_name = 'Total Reserves'\nAND g.year BETWEEN 2010 AND 2020\nORDER BY g.year",
      "difficulty": "medium",
      "category": "join_filter"
    },
    {
      "id": 57,
      "question": "Find countries with the highest volatility (standard deviation) in unemployment rate from 2010 to 2020",
      "ground_truth_sql": "SELECT c.country_name, \n       AVG(g.value) AS avg_unemployment,\n       COUNT(*) AS data_points,\n       (SUM(g.value * g.value) / COUNT(*)) - (AVG(g.value) * AVG(g.value)) AS variance\nFROM gem_observations g\nJOIN countries c ON g.country_id = c.country_id\nJOIN indicators i ON g.indicator_id = i.indicator_id\nWHERE i.indicator_name = 'Unemployment Rate'\nAND g.year BETWEEN 2010 AND 2020\nGROUP BY c.country_name\nHAVING COUNT(*) >= 5\nORDER BY variance DESC\nLIMIT 10",
      "difficulty": "hard",
      "category": "statistical"
    },
    {
      "id": 58,
      "question": "Calculate the cumulative sum of tax revenue over years for Australia",
      "ground_truth_sql": "WITH yearly_tax AS (\n    SELECT g.year, g.value AS tax_revenue\n    FROM gfs_observations g\n    JOIN countries c ON g.country_id = c.country_id\n    JOIN sectors s ON g.sector_id = s.sector_id\n    JOIN indicators i ON g.indicator_id = i.indicator_id\n    WHERE c.country_name = 'Australia'\n    AND s.sector_name = 'General government'\n    AND i.indicator_name = 'Taxes, Transactions (cash basis of recording), Cash basis'\n    AND g.transformation = 'Percent of GDP'\n)\nSELECT year, tax_revenue,\n       SUM(tax_revenue) OVER (ORDER BY year) AS cumulative_tax\nFROM yearly_tax\nORDER BY year",
      "difficulty": "hard",
      "category": "window_function"
    },
    {
      "id": 59,
      "question": "Compare government expenditure between central and local government for Brazil over 2015-2022",
      "ground_truth_sql": "SELECT g.year,\n       SUM(CASE WHEN s.sector_name = 'Central government including social security' THEN g.value ELSE 0 END) AS central_govt,\n       SUM(CASE WHEN s.sector_name = 'Local Government' THEN g.value ELSE 0 END) AS local_govt,\n       SUM(CASE WHEN s.sector_name = 'Central government including social security' THEN g.value ELSE 0 END) -\n       SUM(CASE WHEN s.sector_name = 'Local Government' THEN g.value ELSE 0 END) AS difference\nFROM gfs_observations g\nJOIN countries c ON g.country_id = c.country_id\nJOIN sectors s ON g.sector_id = s.sector_id\nJOIN indicators i ON g.indicator_id = i.indicator_id\nWHERE c.country_name = 'Brazil'\nAND i.indicator_name = 'Expenditure, Transactions (cash basis of recording), Cash basis'\nAND g.transformation = 'Percent of GDP'\nAND g.year BETWEEN 2015 AND 2022\nGROUP BY g.year\nORDER BY g.year",
      "difficulty": "hard",
      "category": "cross_sector_comparison"
    },
    {
      "id": 60,
      "question": "Rank countries by their average GDP growth from 2015 to 2020, showing only the top 15",
      "ground_truth_sql": "WITH gdp_by_year AS (\n    SELECT c.country_name, g.year, g.value AS gdp\n    FROM gem_observations g\n    JOIN countries c ON g.country_id = c.country_id\n    JOIN indicators i ON g.indicator_id = i.indicator_id\n    WHERE i.indicator_name = 'GDP at market prices'\n    AND i.unit = 'constant 2010 US$, millions'\n    AND g.year BETWEEN 2014 AND 2020\n),\ngrowth_rates AS (\n    SELECT country_name, year,\n           (gdp - LAG(gdp) OVER (PARTITION BY country_name ORDER BY year)) / \n           LAG(gdp) OVER (PARTITION BY country_name ORDER BY year) * 100 AS growth_rate\n    FROM gdp_by_year\n)\nSELECT country_name, AVG(growth_rate) AS avg_growth_rate,\n       RANK() OVER (ORDER BY AVG(growth_rate) DESC) AS rank\nFROM growth_rates\nWHERE growth_rate IS NOT NULL\nGROUP BY country_name\nORDER BY avg_growth_rate DESC\nLIMIT 15",
      "difficulty": "hard",
      "category": "window_function"
    },
    {
      "id": 61,
      "question": "Find the top 5 countries by combined GFS and GEM data availability (total observations)",
      "ground_truth_sql": "WITH combined AS (\n    SELECT country_id, 'GFS' AS source FROM gfs_observations\n    UNION ALL\n    SELECT country_id, 'GEM' AS source FROM gem_observations\n)\nSELECT c.country_name, \n       SUM(CASE WHEN source = 'GFS' THEN 1 ELSE 0 END) AS gfs_obs,\n       SUM(CASE WHEN source = 'GEM' THEN 1 ELSE 0 END) AS gem_obs,\n       COUNT(*) AS total_obs\nFROM combined\nJOIN countries c ON combined.country_id = c.country_id\nGROUP BY c.country_name\nORDER BY total_obs DESC\nLIMIT 5",
      "difficulty": "hard",
      "category": "union_aggregation"
    },
    {
      "id": 62,
      "question": "Identify the year with the largest GDP drop for each major economy (US, China, Japan, Germany, UK) between 2008 and 2022",
      "ground_truth_sql": "WITH gdp_changes AS (\n    SELECT c.country_name, g.year, g.value AS gdp,\n           g.value - LAG(g.value) OVER (PARTITION BY c.country_name ORDER BY g.year) AS gdp_change\n    FROM gem_observations g\n    JOIN countries c ON g.country_id = c.country_id\n    JOIN indicators i ON g.indicator_id = i.indicator_id\n    WHERE c.country_name IN ('United States', 'China', 'Japan', 'Germany', 'United Kingdom')\n    AND i.indicator_name = 'GDP at market prices'\n    AND i.unit = 'constant 2010 US$, millions'\n    AND g.year BETWEEN 2008 AND 2022\n),\nranked AS (\n    SELECT country_name, year, gdp_change,\n           ROW_NUMBER() OVER (PARTITION BY country_name ORDER BY gdp_change ASC) AS rn\n    FROM gdp_changes\n    WHERE gdp_change IS NOT NULL\n)\nSELECT country_name, year AS worst_year, gdp_change AS gdp_drop\nFROM ranked\nWHERE rn = 1\nORDER BY gdp_drop ASC",
      "difficulty": "hard",
      "category": "window_function"
    },
    {
      "id": 63,
      "question": "Compare tax revenues as a percentage of GDP across countries with good data coverage (Singapore, Australia, Israel, South Africa, Chile) for 2020, ranking them from highest to lowest",
      "ground_truth_sql": "WITH Tax_Revenue AS (\n    SELECT \n        c.country_name,\n        g.value AS tax_revenue_pct_gdp\n    FROM gfs_observations g\n    JOIN countries c ON g.country_id = c.country_id\n    JOIN sectors s ON g.sector_id = s.sector_id\n    JOIN indicators i ON g.indicator_id = i.indicator_id\n    WHERE c.country_name IN ('Singapore', 'Australia', 'Israel', 'South Africa', 'Chile')\n        AND g.year = 2020\n        AND s.sector_name = 'General government'\n        AND i.indicator_name = 'Taxes, Transactions (cash basis of recording), Cash basis'\n        AND g.transformation = 'Percent of GDP'\n),\nAvg_Tax AS (\n    SELECT AVG(tax_revenue_pct_gdp) AS avg_tax_revenue\n    FROM Tax_Revenue\n)\nSELECT \n    t.country_name,\n    t.tax_revenue_pct_gdp,\n    a.avg_tax_revenue AS group_average,\n    (t.tax_revenue_pct_gdp - a.avg_tax_revenue) AS difference_from_avg\nFROM Tax_Revenue t\nCROSS JOIN Avg_Tax a\nORDER BY t.tax_revenue_pct_gdp DESC",
      "difficulty": "hard",
      "category": "cross_country_comparison"
    },
    {
      "id": 64,
      "question": "Show the year-over-year change in net lending/borrowing for Singapore's general government from 2015 to 2022, identifying years with deficits (negative values)",
      "ground_truth_sql": "WITH Yearly_Values AS (\n    SELECT \n        g.year,\n        g.value AS current_value,\n        LAG(g.value) OVER (ORDER BY g.year) AS previous_value\n    FROM gfs_observations g\n    JOIN countries c ON g.country_id = c.country_id\n    JOIN sectors s ON g.sector_id = s.sector_id\n    JOIN indicators i ON g.indicator_id = i.indicator_id\n    WHERE c.country_name = 'Singapore'\n        AND s.sector_name = 'General government'\n        AND i.indicator_name = 'Net lending (+) / net borrowing (-), Transactions (cash basis of recording), Cash basis'\n        AND g.transformation = 'Percent of GDP'\n        AND g.year BETWEEN 2015 AND 2022\n)\nSELECT \n    year,\n    current_value,\n    previous_value,\n    (current_value - previous_value) AS yoy_change,\n    CASE \n        WHEN current_value < 0 THEN 'Deficit'\n        ELSE 'Surplus'\n    END AS fiscal_status\nFROM Yearly_Values\nWHERE previous_value IS NOT NULL\nORDER BY year",
      "difficulty": "hard",
      "category": "temporal_analysis"
    },
    {
      "id": 65,
      "question": "Calculate the correlation between government revenue and expenditure across all countries for 2019",
      "ground_truth_sql": "WITH paired_data AS (\n    SELECT c.country_name,\n           SUM(CASE WHEN i.indicator_name LIKE '%Revenue%' THEN g.value ELSE 0 END) AS revenue,\n           SUM(CASE WHEN i.indicator_name LIKE '%Expenditure%' THEN g.value ELSE 0 END) AS expenditure\n    FROM gfs_observations g\n    JOIN countries c ON g.country_id = c.country_id\n    JOIN sectors s ON g.sector_id = s.sector_id\n    JOIN indicators i ON g.indicator_id = i.indicator_id\n    WHERE s.sector_name = 'General government'\n    AND g.transformation = 'Percent of GDP'\n    AND g.year = 2019\n    GROUP BY c.country_name\n    HAVING SUM(CASE WHEN i.indicator_name LIKE '%Revenue%' THEN 1 ELSE 0 END) > 0\n       AND SUM(CASE WHEN i.indicator_name LIKE '%Expenditure%' THEN 1 ELSE 0 END) > 0\n),\nstats AS (\n    SELECT \n        COUNT(*) AS n,\n        SUM(revenue) AS sum_x,\n        SUM(expenditure) AS sum_y,\n        SUM(revenue * expenditure) AS sum_xy,\n        SUM(revenue * revenue) AS sum_xx,\n        SUM(expenditure * expenditure) AS sum_yy\n    FROM paired_data\n)\nSELECT \n    n AS sample_size,\n    (n * sum_xy - sum_x * sum_y) / \n    SQRT((n * sum_xx - sum_x * sum_x) * (n * sum_yy - sum_y * sum_y)) AS correlation\nFROM stats",
      "difficulty": "hard",
      "category": "statistical"
    },
    {
      "id": 66,
      "question": "Identify countries where total expenditure as percent of GDP for general government increased by more than 5 percentage points between 2019 and 2021",
      "ground_truth_sql": "WITH Expenditure_By_Year AS (\n    SELECT \n        c.country_name,\n        SUM(CASE WHEN g.year = 2019 THEN g.value ELSE 0 END) AS exp_2019,\n        SUM(CASE WHEN g.year = 2021 THEN g.value ELSE 0 END) AS exp_2021\n    FROM gfs_observations g\n    JOIN countries c ON g.country_id = c.country_id\n    JOIN sectors s ON g.sector_id = s.sector_id\n    JOIN indicators i ON g.indicator_id = i.indicator_id\n    WHERE s.sector_name = 'General government'\n        AND i.indicator_name = 'Expenditure, Transactions (cash basis of recording), Cash basis'\n        AND g.transformation = 'Percent of GDP'\n        AND g.year IN (2019, 2021)\n    GROUP BY c.country_name\n    HAVING SUM(CASE WHEN g.year = 2019 THEN 1 ELSE 0 END) > 0\n       AND SUM(CASE WHEN g.year = 2021 THEN 1 ELSE 0 END) > 0\n)\nSELECT \n    country_name,\n    exp_2019,\n    exp_2021,\n    (exp_2021 - exp_2019) AS change_pct_points\nFROM Expenditure_By_Year\nWHERE (exp_2021 - exp_2019) > 5\nORDER BY (exp_2021 - exp_2019) DESC",
      "difficulty": "hard",
      "category": "change_detection"
    },
    {
      "id": 67,
      "question": "Calculate the compound annual growth rate (CAGR) of GDP for India from 2010 to 2020",
      "ground_truth_sql": "WITH gdp_endpoints AS (\n    SELECT \n        MAX(CASE WHEN year = 2010 THEN value END) AS gdp_2010,\n        MAX(CASE WHEN year = 2020 THEN value END) AS gdp_2020\n    FROM gem_observations g\n    JOIN countries c ON g.country_id = c.country_id\n    JOIN indicators i ON g.indicator_id = i.indicator_id\n    WHERE c.country_name = 'India'\n    AND i.indicator_name = 'GDP at market prices'\n    AND i.unit = 'constant 2010 US$, millions'\n    AND g.year IN (2010, 2020)\n)\nSELECT gdp_2010, gdp_2020,\n       (POWER(gdp_2020 / gdp_2010, 1.0/10) - 1) * 100 AS cagr_percent\nFROM gdp_endpoints\nWHERE gdp_2010 > 0 AND gdp_2020 > 0",
      "difficulty": "hard",
      "category": "financial_calculation"
    },
    {
      "id": 68,
      "question": "Find countries where government revenue consistently exceeded expenditure (surplus) every year from 2015 to 2020",
      "ground_truth_sql": "WITH fiscal_balance AS (\n    SELECT c.country_name, g.year,\n           SUM(CASE WHEN i.indicator_name LIKE '%Revenue%' THEN g.value ELSE 0 END) AS revenue,\n           SUM(CASE WHEN i.indicator_name LIKE '%Expenditure%' THEN g.value ELSE 0 END) AS expenditure\n    FROM gfs_observations g\n    JOIN countries c ON g.country_id = c.country_id\n    JOIN sectors s ON g.sector_id = s.sector_id\n    JOIN indicators i ON g.indicator_id = i.indicator_id\n    WHERE s.sector_name = 'General government'\n    AND g.transformation = 'Percent of GDP'\n    AND g.year BETWEEN 2015 AND 2020\n    GROUP BY c.country_name, g.year\n    HAVING SUM(CASE WHEN i.indicator_name LIKE '%Revenue%' THEN 1 ELSE 0 END) > 0\n       AND SUM(CASE WHEN i.indicator_name LIKE '%Expenditure%' THEN 1 ELSE 0 END) > 0\n)\nSELECT country_name, COUNT(*) AS years_with_data,\n       SUM(CASE WHEN revenue > expenditure THEN 1 ELSE 0 END) AS surplus_years\nFROM fiscal_balance\nGROUP BY country_name\nHAVING COUNT(*) >= 5 AND SUM(CASE WHEN revenue > expenditure THEN 1 ELSE 0 END) = COUNT(*)\nORDER BY country_name",
      "difficulty": "hard",
      "category": "complex_aggregation"
    },
    {
      "id": 69,
      "question": "Find the country with the largest deterioration in net lending/borrowing (as percent of GDP) during 2019-2020",
      "ground_truth_sql": "WITH balance AS (\n    SELECT\n        c.country_name,\n        g.year,\n        g.value AS net_lending_pct_gdp\n    FROM gfs_observations g\n    JOIN countries c ON g.country_id = c.country_id\n    JOIN sectors s ON g.sector_id = s.sector_id\n    JOIN indicators i ON g.indicator_id = i.indicator_id\n    WHERE s.sector_name = 'General government'\n        AND i.indicator_name = 'Net lending (+) / net borrowing (-), Transactions (cash basis of recording), Cash basis'\n        AND g.transformation = 'Percent of GDP'\n        AND g.year IN (2019, 2020)\n),\npaired AS (\n    SELECT\n        b2019.country_name,\n        b2019.net_lending_pct_gdp AS value_2019,\n        b2020.net_lending_pct_gdp AS value_2020,\n        (b2020.net_lending_pct_gdp - b2019.net_lending_pct_gdp) AS change_2020_minus_2019\n    FROM balance b2019\n    JOIN balance b2020\n      ON b2019.country_name = b2020.country_name\n     AND b2019.year = 2019\n     AND b2020.year = 2020\n)\nSELECT\n    country_name,\n    value_2019,\n    value_2020,\n    change_2020_minus_2019\nFROM paired\nORDER BY change_2020_minus_2019 ASC\nLIMIT 1",
      "difficulty": "hard",
      "category": "temporal_analysis"
    },
    {
      "id": 70,
      "question": "Compare government revenue and expenditure as percent of GDP for Australia across all available years, showing the fiscal balance (revenue minus expenditure)",
      "ground_truth_sql": "SELECT\n    g.year,\n    SUM(CASE WHEN i.indicator_name = 'Revenue, Transactions (cash basis of recording), Cash basis' THEN g.value ELSE 0 END) AS revenue_pct_gdp,\n    SUM(CASE WHEN i.indicator_name = 'Expenditure, Transactions (cash basis of recording), Cash basis' THEN g.value ELSE 0 END) AS expenditure_pct_gdp,\n    SUM(CASE WHEN i.indicator_name = 'Revenue, Transactions (cash basis of recording), Cash basis' THEN g.value ELSE 0 END) -\n    SUM(CASE WHEN i.indicator_name = 'Expenditure, Transactions (cash basis of recording), Cash basis' THEN g.value ELSE 0 END) AS fiscal_balance\nFROM gfs_observations g\nJOIN countries c ON g.country_id = c.country_id\nJOIN sectors s ON g.sector_id = s.sector_id\nJOIN indicators i ON g.indicator_id = i.indicator_id\nWHERE c.country_name = 'Australia'\n    AND s.sector_name = 'General government'\n    AND g.transformation = 'Percent of GDP'\n    AND i.indicator_name IN ('Revenue, Transactions (cash basis of recording), Cash basis', \n                             'Expenditure, Transactions (cash basis of recording), Cash basis')\nGROUP BY g.year\nHAVING SUM(CASE WHEN i.indicator_name = 'Revenue, Transactions (cash basis of recording), Cash basis' THEN 1 ELSE 0 END) > 0\n   AND SUM(CASE WHEN i.indicator_name = 'Expenditure, Transactions (cash basis of recording), Cash basis' THEN 1 ELSE 0 END) > 0\nORDER BY g.year",
      "difficulty": "hard",
      "category": "cross_indicator_comparison"
    }
  ]